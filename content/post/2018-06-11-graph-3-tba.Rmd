---
title: 'Graph 3: Radar'
author: ''
date: '2018-06-12'
slug: graph-3-tba
categories: []
tags: []
description: Desc
hacker_news_id: ''
lobsters_id: ''
meta_img: /images/image.jpg 
---

```{r setup, include=FALSE} 
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse) 
library(ggplot2)
#library(ggalt)
library(ggradar)
library(extrafont)
library(ggfortify)
library(infer)
library(forcats)
library(ggridges)
library(here)
library(scales)
```



```{r}
alldicts <- read_csv(here('static','data','redditProject','medoutput.csv'))

alldicts <- alldicts %>% 
  filter(subreddit!='subreddit' & subreddit!='TypeError') %>% 
  mutate_at(vars(ends_with('freq')), as.numeric)

alldictslong <- alldicts %>% 
  gather(key='dictionary',value='freq',-subreddit,-'count(1)',-'sum(wordcount)') %>% 
  select(subreddit,dictionary,freq)%>%   
  mutate_at('dictionary', as.factor) %>% 
  group_by(subreddit)
```

```{r echo=FALSE, absolutistcolsetup} 
subabs <- alldictslong %>% 
  mutate(absolutist=case_when(
           dictionary == 'absolutistfreq' ~ freq,
           dictionary != 'absolutistfreq' ~ 0)) %>% 
  group_by(subreddit) %>% 
  summarize(absolutist=max(absolutist))

alldictslong <- inner_join(alldictslong,subabs,by="subreddit")

```
```{r echo= FALSE, dictcatManipulation}

alldictslong <- alldictslong %>% 
  mutate(dictcat=case_when(
           dictionary %in% c('ifreq','wefreq','ipronfreq','theyfreq','youfreq','shehefreq','pronounfreq','ppronfreq')
           ~ 'pronons',
           dictionary %in% c('verbfreq','auxverbfreq','pastfreq','presentfreq','futurefreq')
           ~ 'verbs',
           dictionary %in% c('articlefreq','adverbfreq','prepsfreq','conjfreq','negatefreq','quantfreq','numberfreq','swearfreq','functfreq')
           ~ 'otherfunctional',
           dictionary %in% c('socialfreq','familyfreq','friendfreq','humansfreq')
           ~ 'people',
           dictionary %in% c('affectfreq','posemofreq','negemofreq','anxfreq','angerfreq','sadfreq')
           ~ 'feelings',
           dictionary %in% c('cogmechfreq','insightfreq','causefreq','discrepfreq','tentatfreq','certainfreq','inhibfreq','inclfreq','exclfreq')
           ~ 'unlabeled',
           dictionary %in% c('perceptfreq','seefreq','hearfreq','feelfreq')
           ~ 'sense',
           dictionary %in% c('biofreq','bodyfreq','healthfreq','sexualfreq','ingestfreq')
           ~ 'bio',
           dictionary %in% c('relativfreq','motionfreq','spacefreq','timefreq')
           ~ 'physics',
           dictionary %in% c('workfreq','achievefreq','leisurefreq','homefreq','moneyfreq','religfreq','deathfreq')
           ~ 'life',
           dictionary %in% c('assentfreq','nonflfreq','fillerfreq')
           ~ 'idk'))
```


```{r}

 normalit<-function(m){
   (m - min(m))/(max(m)-min(m))
 }

dictsubset=c('absolutistfreq','pronounfreq','socialfreq','perceptfreq','sadfreq')

ofinterestplus=c('SuicideWatch', 'Anxiety','depression', 'raisedbynarcissists','trees','gaybros','TwoXChromosomes')

alldictslong %>%
  filter(subreddit %in% ofinterestplus) %>% 
  filter(dictionary %in% dictsubset | dictcat=='feelings') %>% 
  select('subreddit', 'freq','dictionary') %>% 
  spread(dictionary,freq)-> alldictsradar

ggradar(alldictsradar,grid.mid=.1,grid.max = .25, group.line.width = .75,
  group.point.size = 3,label.gridline.max = FALSE,label.gridline.mid = FALSE,label.gridline.min = FALSE)
```



```{r, fig.height=7, fig.width=10 }
radar_colour=rep(c("#FF5A5F", "#FFB400", "#007A87",  "#8CE071", "#7B0051", 
                       "#00D1C1", "#FFAA91", "#B4A76C", "#9CA299", "#565A5C", "#00A04B", "#E54C20"), 100)

clusters <- read_csv(here('static','data','redditProject','centers')) 

clusters <- clusters %>%  
  mutate_at(vars(starts_with('d')),rescale)
clusters
 
#dlabels= c('verb, work, i','relative, cogmech, present','social, i, affect','ppron, pronoun, social','1 funct, pronoun, cogmech','5 affect, pos emotion, relative','7 money, cause, present','6 work, money, bio','9 percept, cogmech, negemo ','10 bio, work, cogmech','11 money, cogmech, bio')

ggradar(clusters[1,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 4,
        #axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour)+ 
  ggtitle("point1")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


ggradar(clusters[2,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 4,
        #axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour[2])+
  ggtitle("point2")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 

ggradar(clusters[3,],grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 4,
        #axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour[3])+
  ggtitle("point3")+ 
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


ggradar(clusters[4,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 3,
        #axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour[4])+
  ggtitle("point4")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


ggradar(clusters[5,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 3,
        #axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour[5])+
  ggtitle("point5")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 

          
          
ggradar(clusters[6,], grid.label.size = 5,
        group.point.size = 4,
        axis.label.size = 3,
        #axis.labels = dlabels,
        legend.text.size = 9, 
        group.colours = radar_colour[6])+
  ggtitle("point6")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


ggradar(clusters[7,], grid.label.size = 5,
        group.point.size = 4,
        axis.label.size = 3,
        #axis.labels = dlabels,
        legend.text.size = 9,
        group.colours = radar_colour[7])+
  ggtitle("point7")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


radar <- ggradar(clusters, 
                 font.radar = 'Lato', 
                 grid.label.size = 0,
                 group.point.size = 3,
                 axis.label.size = 3,
                 #axis.labels = dlabels,
                 legend.text.size = 0
                 )+
  ggtitle("7 cluster centers in 11 dimensions")+
#  facet_wrap(~X1)+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato'))


radar
#ggsave("clusterRadar.pdf",plot = radar)

```


radar_colour=rep(c("#FF5A5F", "#FFB400", "#007A87",  "#8CE071", "#7B0051", 
                       "#00D1C1", "#FFAA91", "#B4A76C", "#9CA299", "#565A5C", "#00A04B", "#E54C20"), 100)

clusters <- read_csv(here('static','data','redditProject','subsetcenters')) 

clusters <- clusters %>%  
  mutate_at(vars(starts_with('d')),rescale)
clusters
 
dlabels= c('1 funct, pronoun, cogmech',
           '2 ppron, social, pronoun',
           '3 social, i, affect',
           '4 relativ, present, cogmech',
           '5 work, money, negemo',
           '6 relativ, affect, time',
           '7 work, verb, relativ',
           '8 negemo, percept, affect',
           '9 bio, leisure, cogmech',
           '10 cogmech, money, bio',
           '11 money, present, you')

ggradar(clusters[1,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 4,
        axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour)+ 
  ggtitle("subset point1")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


ggradar(clusters[2,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 4,
        axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour[2])+
  ggtitle("subset point2")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 

ggradar(clusters[3,],grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 4,
        axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour[3])+
  ggtitle("subset point3")+ 
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


ggradar(clusters[4,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 3,
        axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour[4])+
  ggtitle("subset point4")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


ggradar(clusters[5,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 3,
        axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour[5])+
  ggtitle("subset point5")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 

          
          
ggradar(clusters[6,], grid.label.size = 5,
        group.point.size = 4,
        axis.label.size = 2,
        axis.labels = dlabels,
        legend.text.size = 9, 
        group.colours = radar_colour[6])+
  ggtitle("subset point6")+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


ggradar(clusters[7,], grid.label.size = 5,
        group.point.size = 4,
        axis.label.size = 3, 
        axis.labels = dlabels,
        legend.text.size = 9,
        group.colours = radar_colour[7])+
  ggtitle("subset point7")+ 
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato')) 


radar <- ggradar(clusters, 
                 font.radar = 'Lato', 
                 grid.label.size = 0,
                 group.point.size = 3,
                 axis.label.size = 3,
                 axis.labels = dlabels,
                 legend.text.size = 0
                 )+
  ggtitle("7 cluster centers in 21 dimensions")+
#  facet_wrap(~X1)+
  theme(legend.position="bottom") + 
  theme(text=element_text(family='Lato'))


radar
#ggsave("clusterRadar.pdf",plot = radar)


