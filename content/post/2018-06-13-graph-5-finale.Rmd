---
title: 'Graph 5: Finale'
author: ''
date: '2018-06-13'
slug: graph-5-finale
categories: []
tags: []
description: Desc
hacker_news_id: ''
lobsters_id: ''
meta_img: /images/image.jpg
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
#library(ggalt)
library(ggradar)
library(extrafont)
library(ggfortify)
library(infer)
library(forcats)
library(ggridges)
library(here)
library(scales)
library(ggdendro)
library(treemapify)
library(ggplot2)
library(reshape2)
library(knitr)
```

```{r}
nfreqs <- read_csv(here('static','data','redditProject','normal_subset_freqs.csv'))

redfreqs <- read_csv(here('static','data','redditProject','reduced_normal_subset_freqs'))

hc <- hclust(dist(nfreqs[-1]), method='average')

# labels=nfreqs['subreddit']
cutmatrix <- cutree(hc, k=c(4,8,16,24))

cutmatrix
clusterings <- melt(cutmatrix, varnames=c('subreddit', 'cluster_num'), value.name = 'cluster')

clusterings['subreddit'] <- nfreqs['subreddit']

clusters <- clusterings %>% 
  group_by(cluster_num,cluster) %>% 
  summarise(c=n()) 


#%>% 
#  filter(count>5&count <50) %>% 
#  sample_n(5)

scluster <- clusterings %>% 
  spread(cluster_num, cluster) %>% 
  rename('c4'='4', 'c8'='8', 'c16'='16','c24'='24')

ggplot(clusters, aes(area = c, fill = cluster, group=cluster_num)) +
  geom_treemap()

```
