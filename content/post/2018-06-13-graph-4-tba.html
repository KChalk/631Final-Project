---
title: 'Graph 4: PCA Correlations '
author: ''
date: '2018-06-13'
slug: graph-4-tba
categories: []
tags: []
description: Desc
hacker_news_id: ''
lobsters_id: ''
meta_img: /images/image.jpg
---



<pre class="r"><code>covariances &lt;- read_csv(here(&#39;static&#39;,&#39;data&#39;,&#39;redditProject&#39;,&#39;subset_covariance.csv&#39;))</code></pre>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   X1 = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<pre class="r"><code>covlong &lt;- gather(covariances, key=newDimension, value=covariance, -X1)

ggplot(covlong, aes(x=newDimension, y=X1, fill=covariance))+
  geom_tile()+
  theme(axis.text.x = element_text(angle = 60, hjust = 1))</code></pre>
<p><img src="/post/2018-06-13-graph-4-tba_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code>nfreqs &lt;- read_csv(here(&#39;static&#39;,&#39;data&#39;,&#39;redditProject&#39;,&#39;normal_subset_freqs.csv&#39;))</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   subreddit = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<pre class="r"><code>redfreqs &lt;- read_csv(here(&#39;static&#39;,&#39;data&#39;,&#39;redditProject&#39;,&#39;reduced_normal_subset_freqs&#39;))</code></pre>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   X1 = col_integer()
## )
## See spec(...) for full column specifications.</code></pre>
<pre class="r"><code>od_num=65
pc_num=21

correlations &lt;- cor(nfreqs[c(2:(od_num+1))],redfreqs[c(2:(pc_num+1))])

corlong &lt;- melt(correlations ) %&gt;% 
   setNames(c(&#39;orig&#39;, &#39;red_dim&#39;, &#39;correlation&#39;))


ggplot(corlong, aes(x=red_dim, y=orig, fill=correlation))+
  geom_tile()+ 
  theme(axis.text.x = element_text(angle = 60, hjust = 1))+
  scale_fill_distiller(palette = &quot;PRGn&quot;)</code></pre>
<p><img src="/post/2018-06-13-graph-4-tba_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>  #scale_fill_viridis(option=&#39;E&#39;)</code></pre>
<pre class="r"><code>corlong &lt;- corlong %&gt;% 
  mutate(dictcat=case_when(
           orig %in% c(&#39;ifreq&#39;,&#39;wefreq&#39;,&#39;ipronfreq&#39;,&#39;theyfreq&#39;,&#39;youfreq&#39;,&#39;shehefreq&#39;,&#39;pronounfreq&#39;,&#39;ppronfreq&#39;)
           ~ &#39;pronons&#39;,
           orig %in% c(&#39;verbfreq&#39;,&#39;auxverbfreq&#39;,&#39;pastfreq&#39;,&#39;presentfreq&#39;,&#39;futurefreq&#39;)
           ~ &#39;verbs&#39;,
           orig %in% c(&#39;articlefreq&#39;,&#39;adverbfreq&#39;,&#39;prepsfreq&#39;,&#39;conjfreq&#39;,&#39;negatefreq&#39;,&#39;quantfreq&#39;,&#39;numberfreq&#39;,&#39;swearfreq&#39;,&#39;functfreq&#39;)
           ~ &#39;otherfunctional&#39;,
           orig %in% c(&#39;socialfreq&#39;,&#39;familyfreq&#39;,&#39;friendfreq&#39;,&#39;humansfreq&#39;)
           ~ &#39;people&#39;,
           orig %in% c(&#39;affectfreq&#39;,&#39;posemofreq&#39;,&#39;negemofreq&#39;,&#39;anxfreq&#39;,&#39;angerfreq&#39;,&#39;sadfreq&#39;)
           ~ &#39;feelings&#39;,
           orig %in% c(&#39;cogmechfreq&#39;,&#39;insightfreq&#39;,&#39;causefreq&#39;,&#39;discrepfreq&#39;,&#39;tentatfreq&#39;,&#39;certainfreq&#39;,&#39;inhibfreq&#39;,&#39;inclfreq&#39;,&#39;exclfreq&#39;)
           ~ &#39;unlabeled&#39;,
           orig %in% c(&#39;perceptfreq&#39;,&#39;seefreq&#39;,&#39;hearfreq&#39;,&#39;feelfreq&#39;)
           ~ &#39;sense&#39;,
           orig %in% c(&#39;biofreq&#39;,&#39;bodyfreq&#39;,&#39;healthfreq&#39;,&#39;sexualfreq&#39;,&#39;ingestfreq&#39;)
           ~ &#39;bio&#39;,
           orig %in% c(&#39;relativfreq&#39;,&#39;motionfreq&#39;,&#39;spacefreq&#39;,&#39;timefreq&#39;)
           ~ &#39;physics&#39;,
           orig %in% c(&#39;workfreq&#39;,&#39;achievefreq&#39;,&#39;leisurefreq&#39;,&#39;homefreq&#39;,&#39;moneyfreq&#39;,&#39;religfreq&#39;,&#39;deathfreq&#39;)
           ~ &#39;life&#39;,
           orig %in% c(&#39;assentfreq&#39;,&#39;nonflfreq&#39;,&#39;fillerfreq&#39;, &#39;absolutistfreq&#39;)
           ~ &#39;idk&#39;))


ggplot(corlong, aes(x=red_dim, y=orig, fill=correlation))+
  geom_tile()+
  theme(axis.text.x = element_text(angle = 60, hjust = 1))+
  scale_fill_distiller(palette = &quot;PRGn&quot;)+
  facet_wrap(~dictcat, scales=&#39;free&#39;)</code></pre>
<p><img src="/post/2018-06-13-graph-4-tba_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>  #scale_fill_viridis(option=&#39;E&#39;) 

workingdf &lt;- corlong %&gt;% 
  filter(red_dim==&#39;d1&#39;) %&gt;% 
  mutate(poscor=abs(correlation))


ggplot(workingdf, aes(x=fct_reorder(orig,poscor,.desc = TRUE), y=poscor, fill=dictcat))+
  geom_col()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))</code></pre>
<p><img src="/post/2018-06-13-graph-4-tba_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<pre class="r"><code>workingdf &lt;- corlong %&gt;% 
      filter(red_dim==&#39;d1&#39;) %&gt;% 
      mutate(poscor=abs(correlation), sign=case_when(correlation&gt;=0~&#39;pos&#39;, correlation&lt;0~&#39;neg&#39;))


radar_colour=rep(c(&quot;#FF5A5F&quot;, &quot;#FFB400&quot;, &quot;#007A87&quot;,  &quot;#8CE071&quot;, &quot;#7B0051&quot;, 
                       &quot;#00D1C1&quot;, &quot;#FFAA91&quot;, &quot;#B4A76C&quot;, &quot;#9CA299&quot;, &quot;#565A5C&quot;, &quot;#00A04B&quot;, &quot;#E54C20&quot;), 100)

clusters &lt;- read_csv(here(&#39;static&#39;,&#39;data&#39;,&#39;redditProject&#39;,&#39;centers&#39;)) </code></pre>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   X1 = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<pre class="r"><code>clusters &lt;- clusters %&gt;%  
  mutate_at(vars(starts_with(&#39;d&#39;)),rescale)
clusters</code></pre>
<pre><code>## # A tibble: 7 x 22
##   X1           d1    d2    d3    d4     d5    d6     d7     d8    d9   d10
##   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 [&#39;asktr… 0.0218 0.605 0     1     0.211  0.675 0.455  0.0670 0.978 0.931
## 2 [&#39;jobs&#39;… 0.248  0     0.377 0.450 0      0.560 0.188  0.906  0.477 0    
## 3 [&#39;brasi… 1      1     0.106 0.530 0.631  0     0      1      1     0.161
## 4 [&#39;dirty… 0      0.831 0.470 0.215 0.459  0.424 0.109  0.927  0.452 0.111
## 5 [&#39;gamin… 0.263  0.418 1     0.694 0.0177 0.640 0.0844 0.860  0.521 0.142
## 6 [&#39;nba&#39;,… 0.579  0.451 0.492 0.541 0.129  0.674 0.230  0.644  0     0.474
## 7 [&#39;playr… 0.370  0.213 0.968 0     1      1     1      0      0.295 1    
## # ... with 11 more variables: d11 &lt;dbl&gt;, d12 &lt;dbl&gt;, d13 &lt;dbl&gt;, d14 &lt;dbl&gt;,
## #   d15 &lt;dbl&gt;, d16 &lt;dbl&gt;, d17 &lt;dbl&gt;, d18 &lt;dbl&gt;, d19 &lt;dbl&gt;, d20 &lt;dbl&gt;,
## #   d21 &lt;dbl&gt;</code></pre>
<pre class="r"><code>#dlabels= c(&#39;verb, work, i&#39;,&#39;relative, cogmech, present&#39;,&#39;social, i, affect&#39;,&#39;ppron, pronoun, social&#39;,&#39;1 funct, pronoun, cogmech&#39;,&#39;5 affect, pos emotion, relative&#39;,&#39;7 money, cause, present&#39;,&#39;6 work, money, bio&#39;,&#39;9 percept, cogmech, negemo &#39;,&#39;10 bio, work, cogmech&#39;,&#39;11 money, cogmech, bio&#39;)

ggradar(clusters[1,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 4,
        #axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour)+
  theme(legend.position=&quot;bottom&quot;) </code></pre>
<p><img src="/post/2018-06-13-graph-4-tba_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<pre class="r"><code>pcs &lt;- distinct(corlong[&#39;red_dim&#39;])
clusters &lt;- read_csv(here(&#39;static&#39;,&#39;data&#39;,&#39;redditProject&#39;,&#39;centers&#39;)) </code></pre>
<pre><code>## Warning: Missing column names filled in: &#39;X1&#39; [1]</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   X1 = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<pre class="r"><code>cs &lt;- distinct(clusters[&#39;X1&#39;])

ui &lt;- fluidPage(
  titlePanel(&quot;PCA Correlations&quot;),
  sidebarLayout(
    sidebarPanel(
      selectInput(inputId = &quot;pc&quot;,
                  label = &quot;Principle Component/New Dimemsion&quot;,
                  choices=pcs,
                  selected=&#39;d1&#39;)
      ),
      selectInput(inputId = &quot;clusterN&quot;,
                  label = &quot;Cluster&quot;,
                  choices = list(&quot;Choice 1&quot; = 1, 
                                 &quot;Choice 2&quot; = 2, 
                                 &quot;Choice 3&quot; = 3,
                                 &quot;Choice 4&quot; = 4, 
                                 &quot;Choice 5&quot; = 5, 
                                 &quot;Choice 6&quot; = 6,
                                 &quot;Choice 7&quot; = 7#, 
                                 #&quot;Choice 8&quot; = 8, 
                                 #&quot;Choice 9&quot; = 9,
                                 #&quot;Choice 10&quot; = 10, 
                                 #&quot;Choice 11&quot; = 11
                                 ),
                  selected=1)
      ),
    # Main panel for displaying outputs ----
    mainPanel(

      # Output: Histogram ----
      plotOutput(outputId = &quot;corPlot&quot;),
      plotOutput(outputId = &quot;clusterPlot&quot;)
    )
  ) 


server &lt;- function(input, output) {
  output$corPlot &lt;- renderPlot({
    workingdf &lt;- corlong %&gt;% 
      filter(red_dim==input$pc) %&gt;% 
      mutate(poscor=abs(correlation), sign=case_when(correlation&gt;=0~&#39;pos&#39;, correlation&lt;0~&#39;neg&#39;))
    
    ggplot(workingdf, aes(x=fct_reorder(orig,poscor,.desc = TRUE), y=poscor, color=sign))+
      geom_col()+
      theme(axis.text.x = element_text(angle = 90, hjust = 1))
    
  })

  output$clusterPlot &lt;- renderPlot({
    radar_colour=c(&quot;#FF5A5F&quot;, &quot;#FFB400&quot;, &quot;#007A87&quot;,  &quot;#8CE071&quot;, &quot;#7B0051&quot;, &quot;#00D1C1&quot;, &quot;#FFAA91&quot;, &quot;#B4A76C&quot;, &quot;#9CA299&quot;, &quot;#565A5C&quot;, &quot;#00A04B&quot;, &quot;#E54C20&quot;)
  
    clusters &lt;- read_csv(here(&#39;static&#39;,&#39;data&#39;,&#39;redditProject&#39;,&#39;centers&#39;)) 
    
    clusters &lt;- clusters %&gt;%  
      mutate_at(vars(starts_with(&#39;d&#39;)),rescale)
   
    clusterN=as.numeric(input$clusterN)
    print(clusterN)
    ggradar(clusters[clusterN,], grid.label.size = 5,
        group.point.size = 3,
        axis.label.size = 4,
        #axis.labels = dlabels,
        legend.text.size = 11,
        group.colours = radar_colour[clusterN])+
      theme(legend.position=&quot;bottom&quot;) 
  })

}

shinyApp(ui = ui, server = server)</code></pre>
<div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div>
